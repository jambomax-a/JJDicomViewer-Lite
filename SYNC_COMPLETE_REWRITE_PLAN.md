# 同期ロジック完全書き直し計画

## 現状の問題
1. 解析が甘すぎる
2. 写経が細部までできていない
3. `isKeyView`の条件の意味が理解できていない
4. カスタムロジックが混入している可能性

## 徹底的な解析方針

### 1. `sync:`メソッドの完全解析（DCMView.m:6916-7270）
- 1行ずつ解析
- 条件分岐の意味を完全に理解
- 変数の状態を追跡
- フローを完全に把握

### 2. `sendSyncMessage:`メソッドの完全解析（DCMView.m:6721-6741）
- 呼び出しタイミングの完全把握
- 条件の意味を完全に理解

### 3. `isKeyView`の管理の完全解析
- `becomeFirstResponder`/`resignFirstResponder`の呼び出しタイミング
- `computeMagnifyLens:`での設定
- `newImageViewisKey:`の使用有無

### 4. 完全写経
- HOROS-20240407のコードを1行ずつ写経
- 条件分岐を完全に再現
- 変数名を完全に一致
- ロジックを完全に再現

## 次のステップ

1. `sync:`メソッドを1行ずつ解析
2. 条件分岐の意味を完全に理解
3. 完全写経を実行


